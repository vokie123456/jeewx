function clearLocalstorage(){storage=$.localStorage,storage||(storage=$.cookieStorage),storage.removeAll(),$.messager.alert("信息","浏览器缓存清除成功!")}var easyuiErrorFunction,createGridHeaderContextMenu,easyuiPanelOnMove,tools;$.fn.panel.defaults.onBeforeDestroy=function(){var b,a=$("iframe",this);try{if(a.length>0){for(b=0;b<a.length;b++)a[b].contentWindow.document.write(""),a[b].contentWindow.close();a.remove(),$.browser.msie&&CollectGarbage()}}catch(c){}},$.fn.panel.defaults.loadingMessage="加载中....",$.fn.datagrid.defaults.loadMsg="加载中....",easyuiErrorFunction=function(a){$.messager.progress("close");try{var b=a.responseText.substring(a.responseText.indexOf("错误描述"),a.responseText.indexOf("错误信息"));$.messager.alert("错误",b)}catch(c){$.messager.alert("错误",a.responseText+"")}},$.fn.datagrid.defaults.onLoadError=easyuiErrorFunction,$.fn.treegrid.defaults.onLoadError=easyuiErrorFunction,$.fn.tree.defaults.onLoadError=easyuiErrorFunction,$.fn.combogrid.defaults.onLoadError=easyuiErrorFunction,$.fn.combobox.defaults.onLoadError=easyuiErrorFunction,$.fn.form.defaults.onLoadError=easyuiErrorFunction,createGridHeaderContextMenu=function(a){var c,d,e,f,g,h,i,j,k;if(a.preventDefault(),c=$(this),d=this.headerContextMenu,!d){for(e=$('<div style="width:100px;"></div>').appendTo("body"),f=c.datagrid("getColumnFields"),console.log("id="+c.attr("id")),storage=$.localStorage,storage||(storage=$.cookieStorage),g=storage.get(c.attr("id")+"hiddenColumns"),h=!0,g&&(h=!1),i=0;i<f.length;i++)if(j=c.datagrid("getColumnOption",f[i]),console.log(f[i]+"="+j.hidden),j.hidden&&0!=j.hidden){if(0==h)for(k=0;k<g.length;k++)g[k].field==f[i]&&0!=g[k].visible&&$('<div iconCls="icon-empty" field="'+f[i]+'"/>').html(j.title).appendTo(e)}else $('<div iconCls="icon-ok" field="'+f[i]+'"/>').html(j.title).appendTo(e);saveHeader(),d=this.headerContextMenu=e.menu({onClick:function(a){var b=$(a.target).attr("field");"icon-ok"==a.iconCls?(c.datagrid("hideColumn",b),$(this).menu("setIcon",{target:a.target,iconCls:"icon-empty"}),saveHeader(b,!0)):"icon-empty"==a.iconCls&&(c.datagrid("showColumn",b),$(this).menu("setIcon",{target:a.target,iconCls:"icon-ok"}),saveHeader(b,!1))}})}d.menu("show",{left:a.pageX,top:a.pageY})},$.fn.datagrid.defaults.onHeaderContextMenu=createGridHeaderContextMenu,$.fn.treegrid.defaults.onHeaderContextMenu=createGridHeaderContextMenu,$.extend($.fn.validatebox.defaults.rules,{eqPwd:{validator:function(a,b){return a==$(b[0]).val()},message:"密码不一致！"}}),$.fn.tree.defaults.loadFilter=function(a){var d,e,f,g,h,i,j,c=$(this).data().tree.options;if(c.parentField){for(d=c.idFiled||"id",e=c.textFiled||"text",f=c.parentField,i=[],j=[],g=0,h=a.length;h>g;g++)j[a[g][d]]=a[g];for(g=0,h=a.length;h>g;g++)j[a[g][f]]&&a[g][d]!=a[g][f]?(j[a[g][f]]["children"]||(j[a[g][f]]["children"]=[]),a[g]["text"]=a[g][e],j[a[g][f]]["children"].push(a[g])):(a[g]["text"]=a[g][e],i.push(a[g]));return i}return a},$.fn.treegrid.defaults.loadFilter=function(a){var d,e,f,g,h,i,j,c=$(this).data().treegrid.options;if(c.parentField){for(d=c.idFiled||"id",e=c.textFiled||"text",f=c.parentField,i=[],j=[],g=0,h=a.length;h>g;g++)j[a[g][d]]=a[g];for(g=0,h=a.length;h>g;g++)j[a[g][f]]&&a[g][d]!=a[g][f]?(j[a[g][f]]["children"]||(j[a[g][f]]["children"]=[]),a[g]["text"]=a[g][e],j[a[g][f]]["children"].push(a[g])):(a[g]["text"]=a[g][e],i.push(a[g]));return i}return a},$.fn.combotree.defaults.loadFilter=$.fn.tree.defaults.loadFilter,easyuiPanelOnMove=function(a,b){var e,f,g,h,i,j,c=a,d=b;1>c&&(c=1),1>d&&(d=1),e=parseInt($(this).parent().css("width"))+14,f=parseInt($(this).parent().css("height"))+14,g=c+e,h=d+f,i=$(window).width(),j=$(window).height(),g>i&&(c=i-e),h>j&&(d=j-f),$(this).parent().css({left:c,top:d})};try{$.fn.dialog.defaults.onMove=easyuiPanelOnMove,$.fn.window.defaults.onMove=easyuiPanelOnMove,$.fn.panel.defaults.onMove=easyuiPanelOnMove}catch(e){}changeTheme=function(a){var e,f,g,b=$("#easyuiTheme"),c=b.attr("href"),d=c.substring(0,c.indexOf("themes"))+"themes/"+a+"/easyui.css";if(b.attr("href",d),e=$("iframe"),e.length>0)for(f=0;f<e.length;f++)g=e[f],$(g).contents().find("#easyuiTheme").attr("href",d);$.cookie("easyuiThemeName",a,{expires:7})},serializeObject=function(a){var b={};return $.each(a.serializeArray(),function(){b[this["name"]]=b[this["name"]]?b[this["name"]]+","+this["value"]:this["value"]}),b},formatString=function(a){for(var b=0;b<arguments.length-1;b++)a=a.replace("{"+b+"}",arguments[b+1]);return a},stringToList=function(a){var b,c,d;if(void 0!=a&&""!=a){for(b=[],c=a.split(","),d=0;d<c.length;d++)b.push(""+c[d]);return b}return[]},$.ajaxSetup({type:"POST",error:function(a){$.messager.progress("close"),$.messager.alert("错误",a.responseText)}}),window.top==window&&(tools={msg:"这是一个工具对象，可以把常用属性放到这个对象上。如：在任意页面用top.currDatagri可以获取当前的datagrid"});